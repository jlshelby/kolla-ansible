[DEFAULT]

[repositories]
offsets = monasca_transform.mysql_offset_specs:MySQLOffsetSpecs
data_driven_specs = monasca_transform.data_driven_specs.mysql_data_driven_specs_repo:MySQLDataDrivenSpecsRepo
offsets_max_revisions = 10

[database]
server_type = mysql:thin
host = {{ database_address }}
database_name = {{ monasca_transform_database_name }}
username = {{ monasca_database_user }}
password = {{ monasca_database_password }}

[messaging]
adapter = monasca_transform.messaging.adapter:KafkaMessageAdapter
topic = {{ monasca_metrics_topic }}
brokers = {{ monasca_kafka_servers }}
publish_kafka_project_id = d2cb21079930415a9f2a33588b9f2bb6
publish_region = local
adapter_pre_hourly = monasca_transform.messaging.adapter:KafkaMessageAdapterPreHourly
topic_pre_hourly = metrics_pre_hourly

[stage_processors]
enable_pre_hourly_processor = True

[pre_hourly_processor]
late_metric_slack_time = 600
enable_instance_usage_df_cache = True
instance_usage_df_cache_storage_level = MEMORY_ONLY_SER_2
enable_batch_time_filtering = True
data_provider=monasca_transform.processor.pre_hourly_processor:PreHourlyProcessorDataProvider
effective_batch_revision=2

[service]
#TODO: Use: {{ monasca_zookeeper_servers }}
coordinator_address = kazoo://localhost:2181
coordinator_group = monasca-transform
election_polling_frequency = 15
enable_debug_log_entries = {{ monasca_logging_debug }}
setup_file = /monasca-transform/setup.py
setup_target = bdist_egg
spark_driver = /monasca-transform-source/monasca_transform-0.15.1.dev12/devstack/files/monasca-transform/driver.py
service_log_path=/var/log/kolla/monasca/
service_log_filename=transform.log
spark_event_logging_enabled = true
spark_jars_list = /opt/spark/external/kafka-0-8/target/spark-streaming-kafka-0-8_2.10-2.2.0.jar,/opt/spark/assembly/target/scala-2.10/jars/scala-library-2.10.6.jar,/opt/spark/assembly/target/scala-2.10/jars/kafka_2.10-0.8.1.1.jar,/opt/spark/assembly/target/scala-2.10/jars/metrics-core-2.2.0.jar,/opt/spark/assembly/target/scala-2.10/jars/drizzle-jdbc-1.3.jar
# TODO: Don't assume local
spark_master_list = spark://localhost:7077
spark_home = /var/lib/kolla/venv/lib/python2.7/site-packages/pyspark/
spark_python_files = /monasca-transform-source/monasca_transform-0.15.1.dev12/scripts/monasca-transform.zip
stream_interval = 600
work_dir = /var/lib/monasca-transform
enable_record_store_df_cache = True
record_store_df_cache_storage_level = MEMORY_ONLY_SER_2
